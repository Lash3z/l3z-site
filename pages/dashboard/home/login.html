<script>
(function(){
  "use strict";

  // ðŸ‘‡ Add your admin usernames here (case-insensitive)
  const ADMIN_USERS = ["LASH3Z","ADMIN","OWNER"];

  const SESSION_KEY = "l3z:session";
  const ADMIN_TOKEN = "admin:token";
  const SESSION_DAYS = 7;    // session lifetime
  const ADMIN_HOURS  = 12;   // auto-unlock lifetime

  function sset(k,v){ localStorage.setItem(k, JSON.stringify(v)); }

  const form = document.querySelector("form");
  const U = document.getElementById("u") || document.querySelector('[name="username"]');
  const P = document.getElementById("p") || document.querySelector('[name="password"]');
  const msg = document.getElementById("msg") || document.createElement("div");

  form.addEventListener("submit",(e)=>{
    e.preventDefault();
    const user = (U.value||"").trim();
    const pass = (P.value||"").trim();
    if(user.length < 3 || pass.length < 3){
      msg.textContent = "Please enter a valid username and password.";
      return;
    }

    // Decide admin by username
    const isAdmin = ADMIN_USERS.includes(user.toUpperCase());

    // Write session
    const session = {
      user: user.toUpperCase(),
      isAdmin,
      expiresAt: Date.now() + SESSION_DAYS*24*60*60*1000
    };
    sset(SESSION_KEY, session);

    // ðŸ”“ Auto-unlock admin on login for admins (no dashboard step needed)
    if(isAdmin){
      const tok = {
        by: session.user,
        ts: Date.now(),
        expiresAt: Date.now() + ADMIN_HOURS*60*60*1000
      };
      sset(ADMIN_TOKEN, tok);
    }

    // Redirect back
    const params = new URLSearchParams(location.search);
    const redirect = params.get("redirect");
    location.replace(redirect || "/pages/dashboard/home/index.html");
  });
})();
</script>
